# GigaChat Integration Guide

## Быстрая настройка GigaChat

### 1. Получение ключа авторизации

1. Перейдите на [GigaChat Developers](https://developers.sber.ru)
2. Зарегистрируйтесь или войдите в систему
3. **ВАЖНО**: Получите **Client ID** и **Client Secret** из личного кабинета
   - Это НЕ готовый ключ авторизации
   - Это два отдельных значения: Client ID и Client Secret
4. Создайте ключ авторизации, закодировав `Client ID:Client Secret` в base64:
   \`\`\`bash
   echo -n "your_client_id:your_client_secret" | base64
   \`\`\`
   
   Или используйте готовый скрипт:
   \`\`\`bash
   cd server && python generate_gigachat_key.py your_client_id your_client_secret
   \`\`\`
5. Используйте полученную base64 строку как ключ авторизации

**⚠️ ВАЖНО**: Текущий ключ в .env файле неправильный! Нужно получить правильные Client ID и Client Secret.

### 2. Настройка окружения

В файле `server/.env` добавьте:

\`\`\`bash
# Переключиться на GigaChat
AI_PROVIDER=gigachat

# Ключ авторизации GigaChat
GIGACHAT_AUTH_KEY=your_authorization_key_here

# API базовый URL (по умолчанию уже настроен)
GIGACHAT_API_BASE=https://gigachat.devices.sberbank.ru/api/v1
\`\`\`

### 3. Тестирование

Запустите тест конфигурации:

\`\`\`bash
cd server && source venv/bin/activate && python test_ai_providers.py
\`\`\`

Для тестирования кэширования токенов:

\`\`\`bash
cd server && source venv/bin/activate && python test_token_caching.py
\`\`\`

### 4. Перезапуск сервера

\`\`\`bash
cd server && source venv/bin/activate && python main.py
\`\`\`

## Особенности GigaChat

- **Автоматическое получение токенов**: Система автоматически получает access token каждые 30 минут
- **Кэширование токенов**: Токены кэшируются и переиспользуются до истечения срока действия
- **Совместимость с OpenAI**: Использует тот же API интерфейс
- **Русский язык**: GigaChat лучше понимает русский язык
- **Бесплатные лимиты**: У GigaChat есть бесплатные лимиты для тестирования

## Переключение между провайдерами

Чтобы переключиться обратно на DeepSeek:

\`\`\`bash
AI_PROVIDER=deepseek
\`\`\`

И наоборот для GigaChat:

\`\`\`bash
AI_PROVIDER=gigachat
\`\`\`

## Устранение неполадок

### Ошибка авторизации
- Проверьте правильность `GIGACHAT_AUTH_KEY`
- Убедитесь, что ключ создан в формате `base64(Client ID:Client Secret)`
- Проверьте, что у вас есть доступ к GigaChat API
- Убедитесь, что Client ID и Client Secret правильные

### Ошибка получения токена
- Проверьте интернет-соединение
- Убедитесь, что ключ авторизации активен

### Ошибка API
- Проверьте лимиты использования
- Убедитесь, что аккаунт не заблокирован

## Преимущества GigaChat

1. **Лучшее понимание русского языка**
2. **Бесплатные лимиты для разработки**
3. **Интеграция с экосистемой Сбера**
4. **Высокое качество ответов на русском языке**

## Сравнение провайдеров

| Параметр | DeepSeek | GigaChat |
|----------|----------|----------|
| Языки | Английский, китайский | Русский, английский |
| Цена | Платно | Бесплатные лимиты |
| Скорость | Быстро | Быстро |
| Качество | Высокое | Высокое |
| API | OpenAI-совместимый | OpenAI-совместимый |
